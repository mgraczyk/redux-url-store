{"version":3,"sources":["FormulaResult.js","EditableTitle.js","FormulaEditor.js","../../../index.js","reducers.js","store.js","App.js","index.js","actions.js"],"names":["FormulaResult","props","result","eval","formula","error","console","log","wrapFormulaResult","connect","state","wrapTitle","title","setTitle","className","type","value","placeholder","onChange","evt","target","wrapFormulaEditor","setFormula","_STATE_PARAM_KEY","sleep","ms","Promise","r","setTimeout","f","cb","limitMs","arguments","length","undefined","ctr","tLast","mark","_callee","myCtr","tWait","_len","args","_key","_args","wrap","_context","prev","next","performance","now","abrupt","Array","apply","sent","stop","putStateInUrl","urlParams","URLSearchParams","window","location","search","encoded","btoa","JSON","stringify","encodeState","set","history","replaceState","concat","pathname","urlStoreMiddleware","timeoutMs","_ref2","dispatch","getState","maybeUpdateStore","action","createUrlStoreMiddleware","initialState","combineReducers","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","reduxStore","createStore","reducers","encodedState","parse","atob","decodeState","get","loadInitialState","applyMiddleware","App","store","EditableTitle","ReactDOM","render","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.da21c698.chunk.js","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\n\nconst FormulaResult = (props) => {\n  let result = null;\n  try {\n    result = eval(props.formula);\n  } catch (error) {\n    console.log(error);\n  }\n\n  return '' + (result ? result : '???');\n};\n\nconst wrapFormulaResult = connect(\n  state => ({ formula: state.formula }),\n);\n\nexport default wrapFormulaResult(FormulaResult);\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport { setTitle } from './actions';\n\nconst Title = (props) => (\n  <input\n    className=\"App-title\"\n    type=\"text\"\n    value={props.title}\n    placeholder=\"Calculation Title...\"\n    onChange={evt => props.setTitle(evt.target.value)}\n    />\n);\n\nconst wrapTitle = connect(\n  state => ({ title: state.title }),\n  { setTitle },\n);\n\nexport default wrapTitle(Title);\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport { setFormula } from './actions';\n\nconst FormulaEditor = (props) => (\n  <input\n    type=\"text\"\n    value={props.formula}\n    placeholder=\"Type Formula...\"\n    onChange={evt => props.setFormula(evt.target.value)}\n    />\n);\n\nconst wrapFormulaEditor = connect(\n  state => ({ formula: state.formula }),\n  { setFormula },\n);\n\nexport default wrapFormulaEditor(FormulaEditor);\n","import _regeneratorRuntime from \"/Users/mgraczyk/dev/redux-url-store/examples/calculator/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mgraczyk/dev/redux-url-store/examples/calculator/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _STATE_PARAM_KEY = '__rus';\nvar _INIT_ACTION_TYPE = 'REACT_URL_STORE_INIT';\n\nvar sleep = function sleep(ms) {\n  return new Promise(function (r) {\n    return setTimeout(r, ms);\n  });\n}; // Wraps a function and forwards results to a callback.\n// Drops pending calls when a new call comes in,\n// but always eventually returns the latest result.\n//\n//         \\       \\   \\  \\\n// wrapped -\\-------\\---\\--\\------------\n//           \\       \\   \\  ~~~~~   <<< Wait a bit (predict cancel)\n//            \\       \\   \\      \\\n// await f ----???-----??x-?x-----???---\n//                \\                  \\\n//      cb -----------------------------\n\n\nvar withEagerLatestRace = function withEagerLatestRace(f, cb) {\n  var limitMs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 300;\n  var ctr = 0;\n  var tLast = 0;\n  return (\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var myCtr,\n          tWait,\n          _len,\n          args,\n          _key,\n          result,\n          _args = arguments;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              myCtr = ctr += 1;\n              tWait = tLast + limitMs - performance.now();\n\n              if (!(tWait > 0)) {\n                _context.next = 5;\n                break;\n              }\n\n              _context.next = 5;\n              return sleep(tWait);\n\n            case 5:\n              if (!(ctr !== myCtr)) {\n                _context.next = 7;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 7:\n              tLast = performance.now();\n\n              for (_len = _args.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = _args[_key];\n              }\n\n              _context.next = 11;\n              return f.apply(void 0, args);\n\n            case 11:\n              result = _context.sent;\n\n              if (ctr === myCtr) {\n                cb(result, args);\n              }\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))\n  );\n}; // TODO: Fix for non-ascii.\n\n\nfunction encodeState(state) {\n  return window.btoa(JSON.stringify(state));\n}\n\nfunction decodeState(encodedState) {\n  if (!encodedState) {\n    return null;\n  }\n\n  try {\n    return JSON.parse(window.atob(encodedState));\n  } catch (error) {\n    console.error(error);\n    return null;\n  }\n}\n\nfunction putStateInUrl(state) {\n  var urlParams = new URLSearchParams(window.location.search);\n  var encoded = encodeState(state);\n  urlParams.set(_STATE_PARAM_KEY, encoded);\n  window.history.replaceState(null, null, \"\".concat(window.location.pathname, \"?\").concat(urlParams));\n}\n\nfunction loadInitialState() {\n  var urlParams = new URLSearchParams(window.location.search);\n  console.log(urlParams);\n  return decodeState(urlParams.get(_STATE_PARAM_KEY)) || {};\n}\n\nfunction createUrlStoreMiddleware() {\n  var timeoutMs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 500;\n  return function (_ref2) {\n    var dispatch = _ref2.dispatch,\n        getState = _ref2.getState;\n    return function (next) {\n      var maybeUpdateStore = withEagerLatestRace(function () {}, function () {\n        putStateInUrl(getState());\n      }, timeoutMs);\n      return function (action) {\n        var result = next(action);\n        maybeUpdateStore();\n        return result;\n      };\n    };\n  };\n}\n\nvar urlStoreMiddleware = createUrlStoreMiddleware();\nexport { loadInitialState, urlStoreMiddleware };","import { combineReducers } from 'redux';\n\nconst initialState = {\n  title: '',\n  formula: '',\n};\n\nconst title = (state = initialState.title, action) => {\n  switch (action.type) {\n    case 'SET_TITLE':\n      return action.title;\n    default:\n      return state;\n  }\n}\n\n\nconst formula = (state = initialState.formula, action) => {\n  switch (action.type) {\n    case 'SET_FORMULA':\n      return action.formula;\n    default:\n      return state;\n  }\n}\n\n\nexport default combineReducers({\n  title,\n  formula,\n});\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport { urlStoreMiddleware, loadInitialState } from 'redux-url-store';\n\nimport reducers from './reducers';\n\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst reduxStore = createStore(\n  reducers,\n  loadInitialState(),\n  composeEnhancers(applyMiddleware(urlStoreMiddleware)),\n);\n\nexport default reduxStore;\n","import React from 'react';\nimport { Provider } from 'react-redux';\n\nimport EditableTitle from './EditableTitle';\nimport FormulaEditor from './FormulaEditor';\nimport FormulaResult from './FormulaResult';\nimport reduxStore from './store';\nimport './App.css';\n\n\nfunction App() {\n  return (\n    <Provider store={reduxStore}>\n      <div className=\"App\">\n        <header>\n          <EditableTitle />\n        </header>\n\n        <div className=\"App-formula\">\n          <div>\n            <span>Formula</span>\n            <span><FormulaEditor /></span>\n          </div>\n          <div>\n            <span>Result</span>\n            <span><FormulaResult /></span>\n          </div>\n        </div>\n        <br/>\n        <br/>\n        <footer>\n          <em>Note: This application stores everything in the URL.\n          <br/>\n          You can share the current state of this this page by sharing the url.</em>\n        </footer>\n      </div>\n    </Provider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","module.exports = {\n  setTitle: title => (\n    { type: 'SET_TITLE', title }),\n\n  setFormula: formula => (\n    { type: 'SET_FORMULA', formula }),\n};\n"],"sourceRoot":""}